require "thor"
require "fileutils"

class Runa < Thor
  def self.exit_on_failure?
    true
  end

  desc "new NAME", "Create a new application"
  def new(name)
    if FileTest.exist?(name)
      raise Thor::Error, "ERROR: '#{File.absolute_path(name)}' already exists"
    end

    FileUtils.mkdir_p(name)
    # .bundle/config
    # lib/name.rb
    # lib/name/lib.rb
    # .gitignore
    # Gemfile
    # main.rb
  end

  desc "run [ARGS]", "Run application with arguments"
  def run_command(*args)
    system("bundle exec ruby -Ilib main.rb #{args.join(" ")}")
  end
  map "run" => "run_command"

  desc "install", "Install gems"
  def install
    system("bundle install")
  end
end

Runa.start(ARGV)